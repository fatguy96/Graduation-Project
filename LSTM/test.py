import numpy as np

from LSTM.lstm import My_LSTM


def load_data(filename='data/data.csv'):
    data = []
    i = 1
    with open(filename, 'r') as f:
        for line in f:
            sample = line.strip().split(',')
            if len(sample) == 15 and i >= 577:
                data.append([float(sample[1]), float(sample[2]), float(sample[3]),
                            float(sample[4]), float(sample[5]), float(sample[6]),
                            float(sample[7]), float(sample[8]), float(sample[9]),
                            float(sample[10]), float(sample[11]), float(sample[12]),
                            float(sample[13]), float(sample[14])])
            i += 1
    data = np.array(data)
    return data


data = load_data()
lstm = My_LSTM(rnn_unit=10, input_size=11, time_step=20, output_size=3, lr=0.006, data=data)
lstm.train_lstm()
lstm.verify()

predict_x = [[170.0, 168.0, 167.0, 151.0, 139.0, 174.0, 136.0, 120.0, 153.0, 61.0, 33.0, 119.0, 141.0, 148.0],
                     [168.0, 167.0, 151.0, 139.0, 174.0, 119.0, 120.0, 153.0, 133.0, 61.0, 33.0, 141.0, 148.0, 107.0],
                     [167.0, 151.0, 139.0, 174.0, 119.0, 141.0, 153.0, 133.0, 127.0, 61.0, 33.0, 148.0, 107.0, 146.0],
                     [151.0, 139.0, 174.0, 119.0, 141.0, 148.0, 133.0, 127.0, 129.0, 61.0, 33.0, 107.0, 146.0, 130.0],
                     [139.0, 174.0, 119.0, 141.0, 148.0, 107.0, 127.0, 129.0, 146.0, 61.0, 33.0, 146.0, 130.0, 116.0],
                     [174.0, 119.0, 141.0, 148.0, 107.0, 146.0, 129.0, 146.0, 130.0, 61.0, 33.0, 130.0, 116.0, 126.0],
                     [119.0, 141.0, 148.0, 107.0, 146.0, 130.0, 146.0, 130.0, 105.0, 61.0, 33.0, 116.0, 126.0, 115.0],
                     [141.0, 148.0, 107.0, 146.0, 130.0, 116.0, 130.0, 105.0, 119.0, 61.0, 33.0, 126.0, 115.0, 93.0],
                     [148.0, 107.0, 146.0, 130.0, 116.0, 126.0, 105.0, 119.0, 120.0, 61.0, 33.0, 115.0, 93.0, 119.0],
                     [107.0, 146.0, 130.0, 116.0, 126.0, 115.0, 119.0, 120.0, 99.0, 61.0, 33.0, 93.0, 119.0, 103.0],
                     [146.0, 130.0, 116.0, 126.0, 115.0, 93.0, 120.0, 99.0, 95.0, 61.0, 33.0, 119.0, 103.0, 106.0],
                     [130.0, 116.0, 126.0, 115.0, 93.0, 119.0, 99.0, 95.0, 105.0, 61.0, 33.0, 103.0, 106.0, 104.0],
                     [116.0, 126.0, 115.0, 93.0, 119.0, 103.0, 95.0, 105.0, 100.0, 61.0, 33.0, 106.0, 104.0, 99.0],
                     [126.0, 115.0, 93.0, 119.0, 103.0, 106.0, 105.0, 100.0, 92.0, 61.0, 33.0, 104.0, 99.0, 107.0],
                     [115.0, 93.0, 119.0, 103.0, 106.0, 104.0, 100.0, 92.0, 91.0, 61.0, 33.0, 99.0, 107.0, 94.0],
                     [93.0, 119.0, 103.0, 106.0, 104.0, 99.0, 92.0, 91.0, 85.0, 61.0, 33.0, 107.0, 94.0, 88.0],
                     [119.0, 103.0, 106.0, 104.0, 99.0, 107.0, 91.0, 85.0, 84.0, 61.0, 33.0, 94.0, 88.0, 81.0],
                     [103.0, 106.0, 104.0, 99.0, 107.0, 94.0, 85.0, 84.0, 79.0, 61.0, 33.0, 88.0, 81.0, 117.0],
                     [106.0, 104.0, 99.0, 107.0, 94.0, 88.0, 84.0, 79.0, 80.0, 61.0, 33.0, 81.0, 117.0, 94.0],
                     [104.0, 99.0, 107.0, 94.0, 88.0, 81.0, 79.0, 80.0, 73.0, 11.0, 33.0, 117.0, 94.0, 71.0]]
predict_x = np.array(predict_x)
predict_y_lstm = lstm.prediction(predict_x[:, :11])
print(predict_y_lstm)
